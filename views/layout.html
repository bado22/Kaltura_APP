<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>HBO GO</title>
  <link "stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel = "stylesheet" href="/stylesheets/style.css" rel="stylesheet">

  <title></title>
</head>
<body>
  <div id="header">
    <img src="/images/hbo.png" alt="hbo go logo"/>
    <nav class="navbar">
      <ul class="nav navbar-nav">
            <li><a href="#">Preview</a></li>
            <li><a href="#">Home</a></li>
            <li><a href="#">Movies</a></li>
            <li><a href="#">Series</a></li>
            <li><a href="#">Comedy</a></li>
            <li><a href="#">Sports</a></li>
            <li><a href="#">Documentaries</a></li>
            <li><a href="#">Late Night</a></li>
          </ul>

    </nav>
  </div>
   <div class="container">
    {% block content %}{% endblock %}
    </div>
    <footer>
      <div id ="filler">
      </div>
      <ul class="navbar-nav">
            <li><a href="#">Devices</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Privacy</a></li>
            <li><a href="#">Terms</a></li>
            <li><a href="#">Legal Notices</a></li>
            <li><a href="#">(c)2014 Home Box Office, Inc. All Rights Reserved</a></li>
      </ul>
    </footer>

  <script type="text/javascript" src="/bower_components/jquery/dist/jquery.min.js"></script>
  <script type="text/javascript" src="/javascripts/script.js"></script>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    var socket = io.connect(); // TIP: .connect with no args does auto-discovery

    socket.on('new_comment', function (new_comment) {
      allComments.push(new_comment);

      if (new_comment.videoTime < currentVideoTime) {
      	console.log(new_comment);
      	// Comment in the past -- put into list
        var commentEntry = createCommentDOM(new_comment);

        var newKey = new_comment.videoTime;
        if (allCommentsHash.hasOwnProperty(newKey)) { // this videoTime exists
          $('#new_comment_container').find('[data-commenttime="'+newKey+'"]').before(commentEntry);
        }
        else {
          var keys = Object.keys(allCommentsHash);
          var myKey = 0;
          for (var i = 0; i < keys.length; i++) {
            var vidTime = parseInt(keys[i]);
            if (newKey < vidTime) {
              break;
            }
            else {
              myKey = vidTime;
            }
          }

          if(myKey === 0) {
            console.log("APPENDING", commentEntry);
            $('#new_comment_container').append(commentEntry);
          }
          else {
            console.log("BEFORE", commentEntry);
            $('#new_comment_container').find('[data-commenttime="'+myKey+'"]').before(commentEntry);
          }
        }
      }
    });
  </script>

</body>
</html>
